function getChordData(b,d,a,c){$.ajax({type:"POST",url:Svrpath+"Country-Partner.aspx/GetJsonStringForChord",contentType:"application/json; charset=utf-8",data:"{ChordReporterId:'"+b+"' ,ChordYear:'"+d+"' ,ChordRecordscount:'"+a+"' ,Chordlang:'"+c+"'}",dataType:"json",success:function(e){paintchordchart(e.d)},error:function(e,g,f){alert(f+" "+g+" "+e)}})}function paintchordchart(b){var f;f='{"data": [{"Reporter": "United States","Partner": "Aruba","Import":1309214.273,"Export": 446132.430,"MetaData":"46~0.0817~1690~0.0422~-863081.843"},{"Reporter": "United States","Partner": "Afghanistan","Import":124107.600,"Export": 1511460.170,"MetaData":"106~0.0077~1166~0.143~1387352.570"},{"Reporter": "United States","Partner": "Angola","Import":9703060.917,"Export": 1422873.066,"MetaData":"18~0.6057~1358~0.1347~-8280187.851"},{"Reporter": "United States","Partner": "Anguila","Import":5922.443,"Export": 52934.466,"MetaData":"20~0.0004~739~0.005~47012.023"},{"Reporter": "United States","Partner": "Albania","Import":15804.487,"Export": 47529.397,"MetaData":"81~0.001~322~0.0045~31724.910"}]}';f='{"data": [{"Reporter": "United States","Partner": "Aruba","Import":1309214.273,"Export": 446132.430,"MetaData":"46~0.0817~1690~0.0422~-863081.843"},{"Reporter": "United States","Partner": "Afghanistan","Import":124107.600,"Export": 1511460.170,"MetaData":"106~0.0077~1166~0.143~1387352.570"},{"Reporter": "United States","Partner": "Angola","Import":9703060.917,"Export": 1422873.066,"MetaData":"18~0.6057~1358~0.1347~-8280187.851"},{"Reporter": "United States","Partner": "Anguila","Import":5922.443,"Export": 52934.466,"MetaData":"20~0.0004~739~0.005~47012.023"},{"Reporter": "United States","Partner": "Albania","Import":15804.487,"Export": 47529.397,"MetaData":"81~0.001~322~0.0045~31724.910"}],"MetaData": [{"Country": "Aruba","MetaData":"1149199.674~135747.078~-1013452.596"},{"Country": "Afghanistan","MetaData":"3336434.781~403441.006~-2932993.775"},{"Country": "Angola","MetaData":"23918854.361~40639411.732~16720557.371"},{"Country": "Albania","MetaData":"4548287.875~1087914.902~-3460372.973"},{"Country": "Andorra","MetaData":"1610110.578~100477.876~-1509632.702"}]}';f='{"data": [{"Reporter": "United States","Partner": "Brazil","Import":21017804.644,"Export": 26175324.386,"MetaData":"2,366~1.31~3,383~2.48~5,157,519.74"},{"Reporter": "United States","Partner": "Canada","Import":227577354.210,"Export": 204720827.311,"MetaData":"3,991~14.21~4,479~19.37~-22,856,526.90"},{"Reporter": "United States","Partner": "China","Import":309530233.196,"Export": 69575613.274,"MetaData":"4,008~19.32~3,913~6.58~-239,954,619.92"},{"Reporter": "United States","Partner": "Germany","Import":72632756.092,"Export": 43220924.954,"MetaData":"3,713~4.53~3,792~4.09~-29,411,831.14"},{"Reporter": "United States","Partner": "France","Import":34582355.372,"Export": 27043697.294,"MetaData":"3,394~2.16~3,458~2.56~-7,538,658.08"},{"Reporter": "United States","Partner": "United Kingdom","Import":48249946.912,"Export": 45707871.116,"MetaData":"3,518~3.01~3,947~4.33~-2,542,075.80"},{"Reporter": "United States","Partner": "Japan","Import":98401031.288,"Export": 51178320.341,"MetaData":"3,491~6.14~3,883~4.84~-47,222,710.95"},{"Reporter": "United States","Partner": "Korea, Rep.","Import":40543872.268,"Export": 28639747.634,"MetaData":"2,956~2.53~3,675~2.71~-11,904,124.63"},{"Reporter": "United States","Partner": "Mexico","Import":178321648.369,"Export": 128997663.332,"MetaData":"3,290~11.13~4,393~12.21~-49,323,985.04"},{"Reporter": "United States","Partner": "Netherlands","Import":16573999.196,"Export": 32346735.106,"MetaData":"2,659~1.03~3,373~3.06~15,772,735.91"},{"Reporter": "United States","Partner": "Other Asia, nes","Import":29349133.093,"Export": 18432345.885,"MetaData":"2,928~1.83~3,366~1.74~-10,916,787.21"},{"Reporter": "United States","Partner": "Venezuela","Import":28780266.837,"Export": 9359766.682,"MetaData":"498~1.80~3,028~0.89~-19,420,500.16"},{"Reporter": "United States","Partner": "Others (208)","Import":496335413.653,"Export": 371071327.615,"MetaData":"N/A~30.98~N/A~35.12~-125,264,086.04"}],"MetaData": [{"Country": "Brazil","MetaData":"127,647,330.79~152,994,742.81~25,347,412.02"},{"Country": "Canada","MetaData":"321,227,567.71~315,176,831.39~-6,050,736.32"},{"Country": "China","MetaData":"1,005,555,225.21~1,201,646,758.08~196,091,532.87"},{"Country": "Germany","MetaData":"938,363,080.00~1,127,839,933.00~189,476,853.00"},{"Country": "France","MetaData":"540,502,282.88~464,112,810.97~-76,389,471.91"},{"Country": "United Kingdom","MetaData":"552,042,034.59~359,615,540.06~-192,426,494.53"},{"Country": "Japan","MetaData":"551,984,750.86~580,718,733.73~28,733,982.87"},{"Country": "Korea, Rep.","MetaData":"323,081,674.75~363,531,063.38~40,449,388.63"},{"Country": "Mexico","MetaData":"234,384,531.89~229,712,337.31~-4,672,194.58"},{"Country": "Netherlands","MetaData":"382,190,421.77~431,502,452.47~49,312,030.70"},{"Country": "Other Asia, nes","MetaData":"174,942,558.83~203,493,849.50~28,551,290.68"},{"Country": "United States","MetaData":"1,601,895,815.13~1,056,712,078.25~-545,183,736.89"},{"Country": "Venezuela","MetaData":"38,676,637.47~56,583,100.32~17,906,462.85"},{"Country": "Others (208)","MetaData":"496,335,413.65~371,071,327.62~-125,264,086.04"}]}';var c=JSON.parse(b);var e=c.data;var a=c.MetaData;var d=chordMpr(e,a);d.addValuesToMap("Reporter").addValuesToMap("Partner").setFilter(function(i,h,g){return(i.Reporter===h.name&&i.Partner===g.name)||(i.Reporter===g.name&&i.Partner===h.name)}).setMetaAccessor(function(i,h,g){if(!i[0]){return 0}return i[0].MetaData}).setAccessor(function(i,h,g){if(!i[0]){return 0}return i[0].Reporter===h.name?+i[0].Import:+i[0].Export});drawChordss(d.getMatrix(),d.getMap(),d.getMetaMatrix(),d.getCountryMetaData())}function drawChordss(n,a,i,s){if($(window).width()<1868){var f=document.getElementById("productImportChart").offsetWidth-5,p=550,o=p/2,q=o-190}else{var f=document.getElementById("productImportChart").offsetWidth-5,p=550,o=p/2,q=o-140}var m=d3.scale.ordinal().range(["#c7b570","#c6cdc7","#335c64","#768935","#507282","#5c4a56","#aa7455","#574109","#837722","#73342d","#0a5564","#9c8f57","#7895a4","#4a5456","#b0a690","#0a3542",]);var k=d3.layout.chord().padding(0.02).sortSubgroups(d3.descending).sortChords(d3.descending);var c=d3.svg.arc().innerRadius(q).outerRadius(q+20);var j=d3.select("#productImportChart").append("svg:svg").attr("width",f).attr("height",p).append("svg:g").attr("id","circle").attr("transform","translate("+f/2+","+p/2+")");j.append("circle").attr("r",q+20);var l=chordRdr(n,a,i,s);k.matrix(n);var r=j.selectAll("g.group").data(k.groups()).enter().append("svg:g").attr("class","group").on("mouseover",t).on("mouseout",function(g){d3.select("#tooltip").style("visibility","hidden")});r.append("svg:path").style("stroke","black").style("fill",function(g){return m(l(g).gname)}).attr("d",c);r.append("svg:text").each(function(g){g.angle=(g.startAngle+g.endAngle)/2}).attr("dy",".35em").style("font-family","helvetica, arial, sans-serif").style("font-size","9px").attr("text-anchor",function(g){return g.angle>Math.PI?"end":null}).attr("transform",function(g){return"rotate("+(g.angle*180/Math.PI-90)+")translate("+(q+26)+")"+(g.angle>Math.PI?"rotate(180)":"")}).text(function(g){return l(g).gname});var b=j.selectAll("path.chord").data(k.chords()).enter().append("svg:path").attr("class","chord").style("stroke",function(g){return d3.rgb(m(l(g).sname)).darker()}).style("fill",function(g){return m(l(g).sname)}).attr("d",d3.svg.chord().radius(q)).on("mouseover",function(g){d3.select("#tooltip").style("visibility","visible").html(e(l(g))).style("top",function(){return(d3.event.pageY-80)+"px"})}).on("mouseout",function(g){d3.select("#tooltip").style("visibility","hidden")});function e(v){var u=d3.format(".1%"),h=d3.format(",.2f");var g;if(v.sIndex!=0){g="<b>"+v.tname+" - "+v.sname+" Trade Stats</b>:<br/>"+" Imports "+h(v.tvalue)+" (US$ Thousand), Share "+v.IPartnerShare+"%.<br/>"+" Exports "+h(v.svalue)+" (US$ Thousand), Share "+v.EPartnerShare+"%.<br/>"+" Trade balance "+v.TradeBalance+" (US$ Thousand).<br/>"}else{g="<b>"+v.sname+" - "+v.tname+" Trade Stats</b>:<br/>"+" Imports "+h(v.svalue)+" (US$ Thousand), Share "+v.IPartnerShare+"%.<br/>"+" Exports "+h(v.tvalue)+" (US$ Thousand), Share "+v.EPartnerShare+"%.<br/>"+" trade balance "+v.TradeBalance+" (US$ Thousand).<br/>"}if(g.indexOf("N/A products")>1){g=g.replace("N/A products","").replace("N/A products","")}return g}function d(u){var h=d3.format(".1%"),g=d3.format(",.2f");return"<b>"+u.gname+" Trade Stats</b>:<br/> <b>Trade Balance (US$ Thousand)</b>  : "+u.balance+"<br/> <b>Export (US$ Thousand)</b>  : "+u.exports+"<br/> <b>Import (US$ Thousand)</b>  : "+u.imports+"<br/>"}function t(h,g){d3.select("#tooltip").style("visibility","visible").html(d(l(h))).style("top",function(){return(d3.event.pageY-80)+"px"});b.classed("fade",function(u){return u.source.index!=g&&u.target.index!=g})}};