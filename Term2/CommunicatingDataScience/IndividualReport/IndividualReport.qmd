---
title: "Comunicating data science"
format:
  docx:
    toc: true
    toc-depth: 4
editor: visual
bibliography: cod.bibtex
---

## Introduction {#sec-introduction1}

<!-- I. Introduction -->

<!-- A. Background and context -->

<!-- B. Purpose and objectives of the report -->

<!-- C. Scope and limitations of the report -->

### Introduction {#sec-introduction2}

Atlantic cod also known by its scientific name Gadus morhua is one of
the most commercially important fish species in the world, with a long
history of human exploitation dating back to the 10th century during by
the Vikings @Kurlansky1998Cod.

This species has been an important source of food and income for coastal
communities across the North Atlantic region, supporting a vast industry
of fishermen, processors and distributors for centuries. However, the
sustainability of the Atlantic cod fishery has been increasingly
threatened in recent years due to overfishing, habitat destruction and
climate change.

The warming of ocean waters, caused by increasing greenhouse gas
emissions, has altered the biology, ecology and behaviour of Atlantic
cod, leading to declines in population and distribution. These changes
have had significant impacts on the commercial fishing industry, which
has relied heavily on Atlantic cod as a source of income and food for
centuries.

In recent years, scientific research and policy efforts have been
focused on understanding the impacts of climate change on Atlantic cod,
and developing sustainable fishing strategies that take into account the
changing environmental conditions.

This report aims to review the current state of knowledge on the impact
of climate change on Atlantic cod, including the ecological and
environmental factors that shape its distribution and abundance,
considering some of the socio-economic implications of its decline and
the strategies for sustainable management and conservation in the face
of climate change.

Through an analysis of the data regarding sea surface temperature
increase and fishing, this report seeks to contribute to a more
comprehensive and evidence-based understanding of the challenges
associated with the Atlantic cod fishery in the era of climate change.

### Background and context

Atlantic cod fishing has a long and complex history that dates back to
at least the 11th century. Cod was a vital food source for European
colonizers and became one of the most important commercial fish species
in the North Atlantic.

The first recorded European explorers to fish for cod in North America
were the Vikings, who fished for cod off the coast of Newfoundland
around 1000 AD. Later, in the 15th and 16th centuries, European
fishermen established seasonal fishing camps along the New England
nicknaming it Cape Cod @Kurlansky1998CodP63.

As European fishing fleets grew in size and range, they began to explore
deeper waters and more distant fishing grounds, leading to the
development of large-scale commercial fishing operations. By the late
18th century, French and English fleets were competing for the rich cod
fisheries of the Grand Banks and other areas leading to the
modernization and a significant increase of cod fishing @Kurlansky1998CodP118.

As such from its beginning of being an important food source, to its
increased values in trade as a commodity and its increased in
significance culturally due to it becoming a staple of many coastal
diets and the naval development that produced experienced seamen and
naval infrastructure that was required during the naval arms race of the
colonial era.

### Objectives

The report aims to analyse the impacts of climate change on Atlantic cod
fisheries in Iceland, Norway, Danish Faroe Islands. The objectives of
the report include evaluating the state of Atlantic cod fisheries from
1950 to 2010, identifying the scientific evidence linking climate change
to changes in Atlantic cod's biology, ecology and behaviour,
identifying the key challenges facing the fisheries and examining
potential innovative management approaches to promote the resilience,
adaptation and sustainability of Atlantic cod fisheries.

The countries of Iceland, Norway and Danish Faroe Islands were chosen due to their
availability of cod in their natural waters, the economy value of the
fish and the historic traditions of cod consumption that started during the Viking
era.

Particularly Iceland's economy has the highest dependence on cod, which is reflected in the graph showing the percentage of cod exports over total exports. 

![Icelandic cod export](IcelandCodExportPercentage.png)
<!-- ## 1 EUR = 148.106 ISK updated Mar 30, 2023, 00:19 UTC -->

<!-- ## 1 USD = 0.922463 EUR Mar 30, 2023, 00:22 UTC -->

<!-- ## https://wits.worldbank.org/CountryProfile/en/Country/ISL/Year/2020/TradeFlow/Export -->

<!-- ## https://statice.is/statistics/business-sectors/fisheries/export-of-marine-products/ -->

These calculations were made using the data of cod exports from the statistics made available by the National Statistical Institute of Iceland @statisticsIceland and the data of Icelandic exports available from the World Bank's World Integrated Trade Solution (WITS) @wits. 

The cod exports were converted from Icelandic Kronur to Euros at the rate of 148.106 ISk per 1€ updated at the 30th of March, 2023 at 00:19 UTC. The total exports from Iceland was converted from United States dollars to euros at a rate of 1US$ = 0.922463€ updated at the 30th of March, 2023 at 00:22 UTC @xe.

<!-- ## specify why these countries -->

<!-- iceland, norway gdp -->

<!-- proof of cultural significance on these countries -->

Overall, the report aims to provide a comprehensive analysis of the
ecological consequences of climate change on Atlantic cod fisheries and
propose strategies for adaptation and mitigation.

<!-- ## exhaustion of cod fisheries (fishing quotas, alternative fishing, like fishlike cod pangaceas) -->

### Scope and limitations

The report is limited in scope to the impacts of climate change on
Atlantic cod fisheries in Norway and Danish Faroe Islands from
1950 to 2010 and Iceland from 2010 to 2021. 
The report does not cover other fish species or historical
changes in Atlantic cod populations prior to the onset of climate
change. The analysis is based on existing scientific research and data,
which may be limited in scope or availability and most likely with measurements errors due to the lack of precision in measurement tools during the first half of the 20th century.
Overfishing is a significant limitation that can be hard to account for in fisheries management. It occurs when fish stocks are harvested at a rate that exceeds their ability to reproduce and replenish themselves, leading to a decline in the population size and potentially even collapse of the fishery.
The data available from ICES during the previously mentioned time period for Norway and Faroe Islands has an annual frequency which does not us factor in the seasonality from fishing seasons to correlate with the temperature.

The report aims to provide a comprehensive
analysis of the issues and potential solutions within the knowledge and
expertise limitations of the author.

<!-- fish data is only yearly and doesnt fully represent fishing seasons -->
<!-- tempature sensitivy of measuring equipment may mean there are -->
<!-- measurement erros which aren't accounted for -->


## Climate Change and its Impact on Cod Fisheries

<!-- A. Causes and Effects of Climate Change -->

<!-- B. Historical Changes in Cod Populations -->

<!-- C. Current Situation of Cod Fisheries -->

### Causes and Effects of Climate Change

Climate change is primarily caused by the increase in greenhouse gases
(GHGs) in the atmosphere, particularly carbon dioxide (CO2). Human
activities, such as burning fossil fuels, deforestation and
agriculture, are the main sources of GHG emissions. These activities
release large amounts of CO2 and as a result the planet is experiencing
a rise in temperature due to the heat-trapping effect of these gases.

Climate change is having a significant impact on plant and animal
species and these changes are having ripple effects throughout
ecosystems. One of the most significant impacts of climate change on
ecosystems is that it is causing shifts in the behavior and distribution
of species. As temperatures and precipitation patterns change, some
species are migrating to cooler or wetter areas. For example, some fish
species are moving further north or to deeper waters in response to
warming ocean temperatures.

These shifts in the distribution of species can have significant
implications for ecosystems. As species move, they may encounter new
competitors, predators, or prey, which can have cascading effects on
food webs. Additionally, if certain species decline or disappear
entirely, it can impact the availability of food and other resources for
other species. This can lead to changes in the abundance and
distribution of species and can have significant impacts on ecosystem
health and function.

These changes in ecosystems can also have impacts on human livelihoods.
For example, in the fishing industry, changes in the distribution of
fish species can impact the abundance and availability of fish, which
can impact the success of fishing operations. These impacts can have
economic and social implications for communities that rely on the
fishing industry for their livelihoods.

### Historical Changes in Cod Populations

Atlantic cod populations have undergone significant changes over the
centuries due to human fishing activities. Before European colonization,
cod populations were plentiful and sustained Indigenous communities
along the coast of North America. However, as commercial fishing began
in the 15th century, the pressure on cod populations increased, leading
to their depletion. By the early 1900s, there were concerns about the
sustainability of the fishery and measures such as fishing quotas and
seasonal closures were implemented to allow for the recovery of the
population.

These conservation measures led to a partial recovery of the cod
population in the mid-20th century. However, during this time,
technological advancements in fishing methods, such as motorized vessels
and sonar technology, allowed for increased efficiency and the
exploitation of deeper waters, further depleting cod populations.
Despite concerns about the sustainability of the fishery, the demand for
cod continued to increase and fishing pressure intensified in the
latter half of the 20th century.

In addition to overfishing, the cod population was also impacted by
changes in the climate. As ocean temperatures increased in the latter
half of the 20th century, the cod's food sources began to shift, leading
to changes in their distribution and abundance @SST. Warmer waters also
allowed for the expansion of predators, such as seals and haddock, which
preyed on cod populations.

These changes in the ocean ecosystem, coupled with overfishing,
contributed to the collapse of multiple fisheries such as the Atlantic
Northwest cod fishery in the 1990s, with cod population reaching 1% of
its historical value despite efforts to regulate fishing and promote
sustainability @colapse.

### Current Situation of Cod Fisheries

<!-- https://www.ices.dk/advice/Fisheries-overviews/Pages/fisheries-overviews.aspx -->

<!-- In Iceland due to the recognition of the importance of sustainable fishing and as such the management of the fishery is largely based on scientific research and collaboration between the government, industry, and stakeholders. -->

<!-- The Icelandic cod fishery has been certified by the MSC, an international organization that sets standards for sustainable fisheries. This certification indicates that it meets the organization's standards for sustainable fishing practices. The certification covers several Icelandic cod fishing areas and includes requirements for effective management, minimizing environmental impact, and maintaining healthy fish populations. The MSC certification has helped to promote the sustainability of Icelandic cod fisheries and increase market demand for certified sustainable seafood . -->

According to the ICES's latest fisheries overviews, the cod population
in Icelandic waters is currently being fished above its sustainable
harvest rate. While the biomass ratios of cod are currently in a
desirable condition, the fishing mortality rates for cod are above the
recommended levels for sustainable fishing @IcelandReport.

In Norway there have been fluctuations in the cod population over the years. While the cod population had declined sharply in the 1980s due to overfishing, there have been some signs of recovery in recent years. However, the cod population in the Norwegian Sea, as well as in some other areas, has been declining since 2014.

ICES data highlights the impact of climate change on the cod population in Norway, with changes in ocean temperature and acidity levels affecting the fish's growth, reproduction and survival rates. However data suggests that measures such as reducing fishing pressure, improving fishing practices and protecting spawning and nursery areas can help to support the recovery and long-term sustainability of the cod population in Norway @NorwayReport.

In the Danish Faroe Islands the subdivision of Atlantic cod (Gadus morhua), North-east Arctic cod stocks that are fished within the Faroese ecoregion has been increasing since the late 1990s and in 2021, the spawning-stock biomass (SSB) was estimated to be at its highest level since the early 1970s. ICES only advises that catches of North-east Arctic cod should not exceed 783,000 tonnes in 2023 @FaroeReport.

Regarding another division of subdivision of Atlantic cod, Faroese cod, the report states that the stock is in a healthy state, with the SSB estimated to be at or above the precautionary reference point. ICES advises that catches of Faroese cod should not exceed 9,815 tonnes in 2023 @FaroeReport.

Lastly, ICES notes that Icelandic cod is currently below the precautionary reference point and ICES advises that no directed fishing for Icelandic cod should take place in 2023 @FaroeReport.


## The Effects of Climate Change on Cod Fisheries

### Iceland

Starting with Iceland, we have gathered data of the sea surface temperature from the NOAA tool kit datasets of the coastal regions surrounding Iceland @toolkit. The caught data was gathered from the ICES dataset of country members @datasetCollections which was used to double check the validity of the monthly caught data from the National Statistical Institute of Iceland @hagstofa.

The country with one of the largest cod fishing industry, it is evident that there has been a clear and gradual increase in the number of cod caught over time from 2010 to 2020 and a small decrease from the start of 2020 till the end of 2021.

![Icelandic monthly cod landing](IcelandSeasonalCodFishing.png)
<!-- Atlought the increase in fishing was very gradual, there was a significant increase in cod market value -->

<!-- ![Icelandic cod export trade value](IcelandCodExportEuros.png) -->

Checking the temperature to look for any similar patterns we can see that temperature did indeed have a slight increase and then decrease why could explain some of the variation of the controlled fishing observed.

![Icelandic monthly temperature variations](IcelandSeasonalTempC.png)

We will start by fitting a linear model to see how much can the change in temperature lead to variation in the number of cod landings

![Linear Model summary](IcelandLinearModel.png)
As we can from the model, temperature is statistically significant and is capable of explaining up tp 20% of variation in cod landings however this model is not capturing the time series aspect of our data.

Which from the temperature to catch ration does seem to hold true as lower temperature values seem to attract a bigger number of cod landings and the inverse also does seem to hold true.

![Icelandic cod export trade value](tempCatchesRelationship.png)


### Faroe Islands

Looking now at the Danish Faroe Islands we have gathered data of the sea surface temperature from the NOAA tool kit datasets of the approximate exclusive economic zone of the Faroe Islands @toolkit. The caught data was again gathered from the ICES dataset of country members @datasetCollections which was also used to double check the validity of the monthly caught data from the Statistics Institution of the Faroe Islands @statisticsFaroeIslands.

From the graph bellow, it is evident that there was a sharp increase in the number of cod caught over time from 2010 to 2016 and a sharper decrease from the start of 2016 till the end of our data in December of 2021.

![Faroe Islands monthly cod landing](FaroeSeasonalCodFishing.png)

Now we will check the temperature to look for any similar patterns we can see that temperature did not follow this trend as it seems to be too gradual to justify any of the sharp increases or decreases in the fishing partners we have previously observed. Exactly at the start there is an increase in temperature that does coincide with a decrease in cod landings but has fishing has a sharp increased and decreased the temperature only very barely decreases until 2020 where it starts increasing which does coincide when the landing decreased becomes even sharper.

Has the graph displays, temperature has a slight increase at the beginning of the of our designated data time frame, peaking at around 2017 and then very gradually decreasing till 2020, where it starts gradually increasing again.

This behaviours might be why we could explain some of the variation of the controlled fishing observed but not the sharp increases and decreases of cod landings during the time frame.

![Faroe Islands monthly temperature variations](FaroeSeasonTemperatureC.png)

Afterwards, We will start by fitting a linear model to see how much can how the multiple gradual changes in temperature are correlated to any of the abrupt variation in the number of cod landings.

![Linear Model summary](FaroeLinearModel.png)
As we can from the model, temperature is still statistically significant and but is only capable of justifying 1 to 2% variation of catches due to the lack of variation of temperature to infer on any of the sharp changes in cod landings, leading us to believe there might be impactful local factors than the global ecosystem change due to global warming, however the available data doesn't cover a sufficient time period to make such statements.

![Faroe Island Temperature to Cod landing relation](FaroeTemperatureCatchRelation.png)
As we can observe from graphic the relation between temperature and and cod landing seems to be no correlation as temperature spikes have little to no effect on the cod landing.

### Norway

As a result of the lack of readily available data it will not be possible to make meaningful comparisons with the previous analysis, furthermore primary data collection would be beyond the scope of this project.

<!-- III. The Effects of Climate Change on Cod Fisheries in Iceland, Danish Faroe Islands, -->
<!--      and Norway A. Denmark Overview of Denmark's Cod Fisheries The -->
<!--      Effects of Climate Change on Denmark's Cod Fisheries B. Iceland -->
<!--      Overview of Iceland's Cod Fisheries The Effects of Climate Change -->
<!--      on Iceland's Cod Fisheries C. Norway Overview of Norway's Cod -->
<!--      Fisheries The Effects of Climate Change on Norway's Cod -->
<!--      Fisheries C. Scotland Overview of Scotland's Cod Fisheries The -->
<!--      Effects of Climate Change on Scotland's Cod Fisheries -->

## Conclusion 

### Summary of findings 

The current study provides an assessment of the current state of the Atlantic cod populations in Norway, the Danish Faroe Islands and Iceland. The analysis reveals that the fishing mortality rates for cod in Norway are above the recommended levels for sustainable fishing, while the cod population in the Norwegian Sea and other areas has been declining since 2014 @NorwayReport. Climate change has been identified as a significant factor affecting the cod population in Norway, with changes in ocean temperature and acidity levels impacting the fish's growth, reproduction and survival rates. However, the study suggests that implementing measures such as reducing fishing pressure, improving fishing practices and protecting spawning and nursery areas can support the recovery and long-term sustainability of the cod population in Norway @NorwayReport.

In the Danish Faroe Islands, the study found that the subdivision of Atlantic cod stocks fished within the Faroese ecoregion has been increasing since the late 1990s, with the spawning-stock biomass (SSB) estimated to be at its highest level since the early 1970s. The report also highlights that the Faroese cod stock is in a healthy state, with the SSB estimated to be at or above the precautionary reference point. However, the study notes that the Icelandic cod stock is currently below the precautionary reference point and no directed fishing for Icelandic cod should take place in 2023 @FaroeReport.

The study also investigates the effects of climate change on cod fisheries in Iceland and finds that there has been a clear and gradual increase in the number of cod caught over time from 2010 to 2020, with a small decrease from the start of 2020 till the end of 2021. Temperature variations were found to be statistically significant in explaining up to 20% of the variation in cod landings. In contrast, the study found that temperature had little to no effect on the cod landing in the Danish Faroe Islands.

Overall, the findings of the present study provide insights into the current state of Atlantic cod populations in Norway, the Danish Faroe Islands and Iceland, highlighting the impact of climate change on these populations and the potential for sustainable fishing practices to support their recovery and long-term sustainability.

### Implications for cod fisheries and fishing communities 


Firstly, the impact of climate change on cod populations cannot be ignored. Changes in ocean temperature can have significant effects on the growth, reproduction, and survival rates of cod @NorwayReport. As such, it may be necessary for fisheries management to take into account the effects of climate change in order to ensure the sustainability of the industry.

The study has found that as water temperatures rise, there is a decrease in the number of Atlantic cod in Iceland, but not in the Faroe Islands. One possible explanation for this is that the range of temperature variation in the Faroe Islands is much smaller than in Iceland, which could help to explain why the impact of rising temperatures on cod populations is less severe in this region.

To further investigate this trend, it may be necessary to identify the critical temperature range at which Atlantic cod populations experience a substantial decline. This would help to provide more specific insights into the factors that contribute to the observed differences in cod populations between Iceland and the Faroe Islands.

Another potential explanation for the differing impact of rising temperatures on cod populations in Iceland and the Faroe Islands is that other subspecies of cod might migrate to the waters around the Faroe Islands, which could help to offset the negative impact of temperature on the local cod population.

<!-- Overall, these findings suggest that further research is needed to understand the complex interactions between temperature and Atlantic cod populations in different regions. -->

<!-- Furthermore, the data presented suggests that there are significant differences in the health of cod stocks in different regions. For example, while the cod population in the Norwegian Sea has been declining since 2014, the stock in the Faroe Islands appears to be in a healthy state. As such, it may be necessary for fisheries management to take a more localized approach, rather than assuming that all cod stocks are equally at risk or attempting a universally applicable solution for all fisheries. -->

The findings presented in the study highlight the need for further research to gain a more comprehensive understanding of the intricate relationship between water temperature and Atlantic cod populations in various regions. 

Moreover, the data indicates that there are substantial disparities in the well-being of cod stocks across different areas. For instance, while the Norwegian Sea's cod population has been decreasing since 2014, the stock in the Faroe Islands seems to be thriving @NorwayReport. Therefore, it may be necessary for fisheries management to adopt a more localized approach instead of assuming that all cod stocks are equally vulnerable or implementing a "one-size-fits-all" solution for all fisheries.

Lastly, it is clear that overfishing has had a significant impact on the cod population, particularly in Norway and that sustainable fishing practices and regulations are necessary to ensure the long-term viability of this industry @NorwayReport. This could involve measures such as reducing fishing pressure, improving fishing practices, protecting spawning and nursery areas and  making fisheries adopt industry standards such as the Marine Stewardship Council (MSC) certification can play an important role in ensuring responsible exploitation of fish stocks @MSC. 

<!-- There are available standard that ensure a sustainable exploitation of fisheries and the government should make it a legal requirement to get the MSC  standard to operate -->

### Future Directions for Research and Action

<!-- continue gathering more data so we can have a longer time frame to allow us to more easily identify trends in our data. Especially because temperature change trends are very slow -->

In addition to continuing to gather more data over a longer time frame, it is also important to increase the frequency and accuracy of data collection to better understand the rate and magnitude of temperature changes in different regions. This will require investment in advanced monitoring technologies and infrastructure to improve the quality and coverage of data collection.

Furthermore, it may be beneficial to expand research beyond just the effects of temperature on Atlantic cod populations, to also investigate the impact of other environmental factors such as ocean acidification and habitat degradation. This will help to better understand the complex interactions between different factors that contribute to changes in fish populations, and inform more comprehensive and effective management strategies.


<!-- This improves the world because goverments can take this data to plan -->
<!-- for longevitie of cod supplies for future generations and not repeat the collapse of the Atlantic northwest cod fishery and its repercusions -->

<!-- As water temperature increases the less fish there is in iceland but not true for faroe islands -->

<!-- The range of temperature variation is much smaller in faroe islands than iceland so that might justify the findings -->

<!-- for further it would be to find the critical temperature range which would lead to a substantial decline to Atlantic cod -->

<!-- A reason why Faroe Islandings might not feel the same effect as Iceland is that some other subspecies of cod might migrate to those waters negative the effect of temperature depleting the population. -->


<!-- VI. References -->

<!-- A. List of Sources Cited -->

<!-- B. Additional Resources for Further Reading -->

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}
library(dplyr)
library(ggplot2)
library(tidyverse)
library(tidyr)
library(DataExplorer)

library(readr)
library(lubridate)

library(tseries)
library(forecast)

library(gridExtra)
library(xts)

library(vars)
library(scales)

#install.packages("forecast")


FishDataSet = read_csv("HistoricalLandings1950-2010/ICES_1950-2010.csv")

## https://www.st.nmfs.noaa.gov/copepod/toolkit/subform_copepodite-c2.html
## get the data from a location

```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}
#FishDataSet$Species

BacalhauDataFrame <- subset(FishDataSet, Species == "Atlantic cod")

```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}
#BacalhauDataFrame$Country

BomBacalhauDataFrame <- subset(BacalhauDataFrame, Country %in% c("Norway", "Iceland", # "Greenland",
  "Denmark","Faeroe Islands", "UK - England & Wales", "UK - Scotland" ))
```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

# total_count <- sum(BomBacalhauDataFrame$1951)

BomBacalhauDataFrameNumeric <- BomBacalhauDataFrame %>% 
     mutate_at(c(4:64), as.numeric)

BomBacalhauDataFrameNumeric = BomBacalhauDataFrameNumeric %>% dplyr::select(-c(Species:Division))

BomBacalhauDataFrameNumeric = BomBacalhauDataFrameNumeric %>% replace(is.na(.), 0)


# Summarize all selected columns by summing them
BacalhauSomado<- BomBacalhauDataFrameNumeric %>%
  group_by(Country) %>%
  summarise_at(vars(`1950`:`2010`), sum, na.rm = TRUE)


## now I just need to see the sea surface temperature change from 1950 to 2010 


```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

IcelandSeaSurfaceTemperature = read_csv("SeaSurfaceTemperature/IcelandSeaSurfaceTemperature.csv")

NorwaySeaSurfaceTemperature = read_csv("SeaSurfaceTemperature/NorwaySeaSurfaceTemperature.csv")

DenmarkSeaSurfaceTemperature = read_csv("SeaSurfaceTemperature/DenmarkSeaSurfaceTemperature.csv")

FaroeIslandsSeaSurfaceTemperature = read_csv("SeaSurfaceTemperature/FaroeIslandsSeaSurfaceTemperature.csv")

#EnglandWalesSeaSurfaceTemperature = read_csv("SeaSurfaceTemperature/EnglandWalesSeaSurfaceTemperature.csv")

ScotlandSeaSurfaceTemperature = read_csv("SeaSurfaceTemperature/ScotlandSeaSurfaceTemperature.csv")


```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

## removing the third non existent variable form all the datasets

IcelandSeaSurfaceTemperature = IcelandSeaSurfaceTemperature %>% dplyr::select(-(...3))
NorwaySeaSurfaceTemperature = NorwaySeaSurfaceTemperature %>% dplyr::select(-(...3))
DenmarkSeaSurfaceTemperature = DenmarkSeaSurfaceTemperature %>% dplyr::select(-(...3))
FaroeIslandsSeaSurfaceTemperature = FaroeIslandsSeaSurfaceTemperature %>% dplyr::select(-(...3))
ScotlandSeaSurfaceTemperature = ScotlandSeaSurfaceTemperature %>% dplyr::select(-(...3))

##maybe add england + wales if needed

str(IcelandSeaSurfaceTemperature)
## the data was indeed correctly stored in the date YYYY-MM-DD format

```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

IcelandSeaSurfaceTemperature <- IcelandSeaSurfaceTemperature[-c(1:600), ]

IcelandSeaSurfaceTemperature <- IcelandSeaSurfaceTemperature[-c(733:864), ]

NorwaySeaSurfaceTemperature <- NorwaySeaSurfaceTemperature[-c(1:600), ]

NorwaySeaSurfaceTemperature <- NorwaySeaSurfaceTemperature[-c(733:864), ]

FaroeIslandsSeaSurfaceTemperature <- FaroeIslandsSeaSurfaceTemperature[-c(1:600), ]

#FaroeIslandsSeaSurfaceTemperature <- FaroeIslandsSeaSurfaceTemperature[-c(733:864), ]

ScotlandSeaSurfaceTemperature <- ScotlandSeaSurfaceTemperature[-c(1:600), ]

ScotlandSeaSurfaceTemperature <- ScotlandSeaSurfaceTemperature[-c(733:864), ]

```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

# Create time series object
timeSeriesIceland <- ts(IcelandSeaSurfaceTemperature$`HSST= HadISST Temperature (C)` , start = ymd("1950-01-15"), frequency = 12)

plot(timeSeriesIceland, main = "Temperature Time Series")

```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

adf.test(timeSeriesIceland)

# If the p-value of the test is less than 0.05, you can reject the null
# hypothesis that the time series is non-stationary and assume that it is
# stationary.

```



```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

arima_model <- auto.arima(timeSeriesIceland)

summary(arima_model)

```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}


NorwayExportEconomy = read_csv("CodEconomy/statistic_id1199193_value-of-exported-goods-from-norway-2012-2022.csv")


NorwayCodEconomy = read_csv("CodEconomy/statistic_id606925_export-value-of-cod-from-norway-2010-2021.csv")

NorwayExportEconomy <- rename(NorwayExportEconomy, "GDP" = `Value of exported goods from Norway from 2012 to 2022 (in billion NOK)`)

NorwayExportEconomy$GDP = NorwayExportEconomy$GDP*1000

NorwayCodEconomy <- rename(NorwayCodEconomy, "GDP" = `Value of cod exported from Norway from 2010 to 2021 (in million NOK)`)

NorwayCodEconomy$GDPEuro = NorwayCodEconomy$GDP*0.088539968

NorwayExportEconomy$GDPEuro = NorwayExportEconomy$GDP*0.088539968

## currency exchange 1 EUR = 11.2953 NOK  Mar 29, 2023, 22:12 UTC

NorwayCodEconomy$ratio = NorwayCodEconomy$GDPEuro / NorwayExportEconomy$GDPEuro * 100



```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}
IcelandCodEconomy = read_csv("CodEconomy/IcelandCodExport.csv")

## now got to convert cod exports from ISK to euros and total exports from usd to euro
IcelandCodEconomy$`Cod Export value ISK` = IcelandCodEconomy$`Cod Export value ISK`*1000

IcelandCodEconomy$CodEuros = IcelandCodEconomy$`Cod Export value ISK`* 0.0067495374

IcelandCodEconomy$`total export thousand USD` = IcelandCodEconomy$`total export thousand USD`*1000


IcelandCodEconomy$ExportEuros = IcelandCodEconomy$`total export thousand USD`*0.92254505

IcelandCodEconomy$ratio = (IcelandCodEconomy$CodEuros/IcelandCodEconomy$ExportEuros) * 100

IcelandCodEconomy$CodEurosMillions = IcelandCodEconomy$CodEuros /1000000

## 1 EUR = 148.106 ISK updated Mar 30, 2023, 00:19 UTC

## 1 USD = 0.922463 EUR Mar 30, 2023, 00:22 UTC

## https://wits.worldbank.org/CountryProfile/en/Country/ISL/Year/2020/TradeFlow/Export

## https://statice.is/statistics/business-sectors/fisheries/export-of-marine-products/
```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

#p1 = 
ggplot(IcelandCodEconomy, aes(x = Year, y = ratio)) +
  geom_line() +
  geom_point() +
  xlab("Year") +
  ylab("Cod export percentage") +
  ggtitle("Iceland percentage of cod revenue per total exports 1999-2020")

#p2 =
ggplot(IcelandCodEconomy, aes(x = Year, y = CodEurosMillions)) +
  geom_line() +
  geom_point() +
  xlab("Year") +
  ylab("Cod export € (Millions)") +
  ggtitle("Iceland cod exports value € (Millions) 1999-2021")




# Combine graphs using patchwork
#gridExtra::grid.arrange(p1,p2, ncol=2)

```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

IcelandSeaSurfaceTemperature$year <- format(IcelandSeaSurfaceTemperature$`DATE-YMD`, "%Y")

IcelandSeaSurfaceTemperatureYearly <- aggregate(. ~ year, data = IcelandSeaSurfaceTemperature, mean)

IcelandSeaSurfaceTemperatureYearly = IcelandSeaSurfaceTemperatureYearly %>% dplyr::select(-(`DATE-YMD`))

# ggplot(IcelandSeaSurfaceTemperatureYearly, aes(x = year, y = `HSST= HadISST Temperature (C)`)) +
#   geom_line() +
#   geom_point() +
#   xlab("Year") +
#   ylab("Cod export € (Millions)") +
#   ggtitle("Iceland cod exports value € (Millions) 1999-2021")


ggplot(IcelandSeaSurfaceTemperature, aes(x = `DATE-YMD`, y = `HSST= HadISST Temperature (C)`)) +
  geom_line() +
  geom_point() +
  xlab("Year") +
  geom_smooth() +
  ylab("Cod export € (Millions)") +
  ggtitle("Iceland temp")


```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}


BacalhauSomado <- BacalhauSomado[-5, ]
BacalhauSomado <- BacalhauSomado[-5, ]


BacalhauSomadoLong <- pivot_longer(BacalhauSomado, cols = `1950`:`2010`, names_to = "year", values_to = "catches")

BacalhauSomadoLong$year = as.Date(paste0(BacalhauSomadoLong$year, "-01-01"), format = "%Y-%m-%d")

BacalhauIslandiaSomado <- subset(BacalhauSomadoLong, Country == "Iceland")

ggplot(BacalhauIslandiaSomado, aes(x = year, y = catches)) +
  geom_line() +
  geom_point() +
  xlab("Year") +
  geom_smooth() +
  ylab("Cod export € (Millions)") +
  ggtitle("Iceland temp")

```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

BacalhauNoruegaSomado <- subset(BacalhauSomadoLong, Country == "Norway")

ggplot(BacalhauNoruegaSomado, aes(x = year, y = catches)) +
  geom_line() +
  geom_point() +
  xlab("Year") +
  geom_smooth() +
  ylab("Cod export € (Millions)") +
  ggtitle("Iceland temp")

ggplot(NorwaySeaSurfaceTemperature, aes(x = `DATE-YMD`, y = `HSST= HadISST Temperature (C)`)) +
  geom_line() +
  geom_point() +
  xlab("Year") +
  geom_smooth() +
  ylab("Cod export € (Millions)") +
  ggtitle("Iceland temp")

```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

BacalhauFaroeSomado <- subset(BacalhauSomadoLong, Country == "Norway")

ggplot(BacalhauFaroeSomado, aes(x = year, y = catches)) +
  geom_line() +
  geom_point() +
  xlab("Year") +
  geom_smooth() +
  ylab("Cod export € (Millions)") +
  ggtitle("Iceland anual catching")

ggplot(FaroeIslandsSeaSurfaceTemperature, aes(x = `DATE-YMD`, y = `HSST= HadISST Temperature (C)`)) +
  geom_line() +
  geom_point() +
  xlab("Year") +
  geom_smooth() +
  ylab("Cod export € (Millions)") +
  ggtitle("Iceland temp")

```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

## https://www.statice.is/statistics/business-sectors/fisheries/catch/

MonthlyIcelandCatches = read_csv("IcelandMonthly/SJA01101.csv")

MonthlyIcelandCatches = slice(MonthlyIcelandCatches, 3:nrow(MonthlyIcelandCatches))

MonthlyIcelandCatchesLong <- pivot_longer(MonthlyIcelandCatches, cols = `2022 January`:`2010 December`, names_to = "date", values_to = "value")

MonthlyIcelandCatchesLong$value = as.numeric(MonthlyIcelandCatchesLong$value)

MonthlyIcelandCatchesLong <- rename(MonthlyIcelandCatchesLong, catches = value)

MonthlyIcelandCatchesLong$date <- as.Date(paste0(MonthlyIcelandCatchesLong$date, " 1"), format = "%Y %B %d")

ggplot(MonthlyIcelandCatchesLong, aes(x = date, y = catches)) +
  geom_line() +
  geom_point() +
  xlab("Year") +
  geom_smooth() +
  ylab("Cod export € (Millions)") +
  ggtitle("Iceland temp")

ggplot(IcelandSeaSurfaceTemperature, aes(x = `DATE-YMD`, y = `HSST= HadISST Temperature (C)`)) +
  geom_line() +
  geom_point() +
  xlab("Year") +
  geom_smooth() +
  ylab("Cod export € (Millions)") +
  ggtitle("Iceland temp")



```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

IcelandSeaSurfaceTemperatureRecently = read_csv("SeaSurfaceTemperature/IcelandSeaSurfaceTemperature.csv")

IcelandSeaSurfaceTemperatureRecently = IcelandSeaSurfaceTemperatureRecently %>% dplyr::select(-(...3))

IcelandSeaSurfaceTemperatureRecently <- IcelandSeaSurfaceTemperatureRecently[-c(1:1320), ]



IcelandSeaSurfaceTemperatureRecently$`DATE-YMD` = as.Date(format(IcelandSeaSurfaceTemperatureRecently$`DATE-YMD`, "%Y-%m-01"))

IcelandSeaSurfaceTemperatureRecently =  rename(IcelandSeaSurfaceTemperatureRecently, date = `DATE-YMD`)
IcelandSeaSurfaceTemperatureRecently =  rename(IcelandSeaSurfaceTemperatureRecently, tempC = `HSST= HadISST Temperature (C)`)


IcelandRecentAnalysis =  merge(MonthlyIcelandCatchesLong, IcelandSeaSurfaceTemperatureRecently, by = "date")

```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}
# Set the date column as index
#library(xts)
IcelandTimeSeriesDf <- xts(IcelandRecentAnalysis[, -1], order.by = IcelandRecentAnalysis$date)

# Convert your data to a time series object
myts <- ts(IcelandTimeSeriesDf, start = c(2000, 1), end = c(2021, 12), frequency = 12)

# Fit a VAR model with two variables and two lags
myvar <- VAR(myts, p = 2)

# Print a summary of the VAR model
summary(myvar)



```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

# Plot the impulse response functions
irf = irf(myvar)

plot(irf)

# irf <- irf(myvar, impulse = "catches", response = c("catches", "tempC"), boot = FALSE)
# plot(irf)

# # Normalize the variables using min-max scaling
# myts_norm <- apply(myts, 2, rescale)
# 
# # Plot the VAR model with normalized variables
# plot(myvar, lags = 2, names = c("Catches", "Temperature"), 
#      col = c("blue", "red"), lwd = 2, gg = list(scale = 5))

```


```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

ggplot(IcelandRecentAnalysis, aes(x = catches, y = tempC)) +
  geom_line() +
  geom_point() +
  xlab("Number of cod catch") +
  geom_smooth() +
  ylab("temperature ºC") +
  ggtitle("Iceland temperature to catch relation")

ggplot(IcelandRecentAnalysis, aes(x = date, y = catches)) +
  geom_line() +
  geom_point() +
  geom_smooth() +
  xlab("Year") +
  ylab("Number of caught cods)") +
  ggtitle("Seasonal cod fishing from 1999-2021")

ggplot(IcelandRecentAnalysis, aes(x = date, y = tempC)) +
  geom_line() +
  geom_point() +
  geom_smooth() +
  xlab("Year") +
  ylab("Temperature ºC") +
  ggtitle("Seasonal temperature fluctuations from 1999-2021")

```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

linearIceland = lm(data = IcelandRecentAnalysis, catches ~ tempC)

summary(linearIceland)

```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}
library(lubridate)
## https://hagstova.fo/en/business/primary-sector/fish-catches

FaroeMonthly = read_csv("FaroeIslandMonthly/fish-catches-faroese-fis.csv")

FaroeMonthly$date =  as.Date(dmy_hm(FaroeMonthly$date))

FaroeIslandsSeaSurfaceTemperature$`DATE-YMD` = as.Date(format(FaroeIslandsSeaSurfaceTemperature$`DATE-YMD`, "%Y-%m-01"))

FaroeIslandsSeaSurfaceTemperature =  rename(FaroeIslandsSeaSurfaceTemperature, date = `DATE-YMD`)
FaroeIslandsSeaSurfaceTemperature =  rename(FaroeIslandsSeaSurfaceTemperature, tempC = `HSST= HadISST Temperature (C)`)

FaraoeMonthlyDf = merge(FaroeIslandsSeaSurfaceTemperature, FaroeMonthly, by = "date")

#FaraoeMonthlyDf = rename(FaraoeMonthlyDf, catches = `Atlantic cod (tons)`)

```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

FaroeIceland = lm(data = FaraoeMonthlyDf, `Atlantic cod (tons)` ~ tempC)

summary(FaroeIceland)

```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}

ggplot(FaraoeMonthlyDf, aes(x = `Atlantic cod (tons)`, y = tempC)) +
  geom_line() +
  geom_point() +
  xlab("Number of cod catch (tons)") +
  geom_smooth() +
  ylab("temperature ºC") +
  ggtitle("Faroe Islands temperature to catch relation")

ggplot(FaraoeMonthlyDf, aes(x = date, y = `Atlantic cod (tons)`)) +
  geom_line() +
  geom_point() +
  geom_smooth() +
  xlab("Year") +
  ylab("Number of caught cods (tons)") +
  ggtitle("Faroe Islands seasonal cod fishing from 1999-2021")

ggplot(FaraoeMonthlyDf, aes(x = date, y = tempC)) +
  geom_line() +
  geom_point() +
  geom_smooth() +
  xlab("Year") +
  ylab("Temperature ºC") +
  ggtitle("Faroe Islands seasonal temperature fluctuations from 1999-2021")

```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}


```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}


```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}


```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}


```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}


```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}


```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}


```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}


```

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72), echo=FALSE, warning=FALSE, output=FALSE}


```

## References
