##connect to the server via ssh

ssh -i ApacheServer_key.pem apacheuser@20.77.1.115

## send requests to the server with ssh tunneling
ssh -i ApacheServer_key.pem -N -L 9092:10.0.0.4:9092 apacheuser@20.77.1.115

## send a file via ssh

#### Set up for kafta install

sudo apt update

sudo apt upgrade

sudo apt install openjdk-8-jdk

wget https://dlcdn.apache.org/kafka/3.5.0/kafka_2.13-3.5.0.tgz

$ tar -xzf kafka_2.13-3.5.0.tgz

sudo mv kafka_2.13-3.5.0 /opt/kafka


## configure kafka ip:

cd /opt/kafka/config/

vim server.properties

listeners=PLAINTEXT://IP_ADDRESS:9092

## set up start up script

touch ZookeeperKafkaStartupScript.sh

vim ZookeeperKafkaStartupScript.sh

#!/bin/bash

echo "Starting Zookeeper"
/opt/kafka/bin/zookeeper-server-start.sh -daemon /opt/kafka/config/zookeeper.properties


echo "Starting Kafka"
/opt/kafka/bin/kafka-server-start.sh -daemon /opt/kafka/config/server.properties


echo "Creating the topic"
/opt/kafka/bin/kafka-topics.sh --create --topic heart-data --bootstrap-server 10.0.0.4:9092

#exit the file and make it executable

chmod +x ZookeeperKafkaStartupScript.sh





## set up with zookeeper without script

# Start the ZooKeeper service in a new terminal
bin/zookeeper-server-start.sh config/zookeeper.properties

/opt/kafka/bin/zookeeper-server-start.sh -daemon /opt/kafka/config/zookeeper.properties

# Start the Kafka broker service in a new terminal without a script
bin/kafka-server-start.sh config/server.properties

/opt/kafka/bin/kafka-server-start.sh -daemon /opt/kafka/config/server.properties


## now the kafta enviroment is ready to use


##### Create a new topic for our events/jobs 

## in 1 terminal we create the topic first called quickstart-events
bin/kafka-topics.sh --create --topic quickstart-events --bootstrap-server localhost:9092

/opt/kafka/bin/kafka-topics.sh --create --topic quickstart-events --bootstrap-server localhost:9092

## now we can check the status on this topic
bin/kafka-topics.sh --describe --topic quickstart-events --bootstrap-server localhost:9092

bin/kafka-topics.sh --describe --topic heart-data --bootstrap-server 10.0.0.4:9092


## Creating 2 messages on the topic
bin/kafka-console-producer.sh --topic heart-data --bootstrap-server 10.0.0.4:9092
>This is the 1st message
>this is 2nd message for debugging

ctrl + c ## this ends the events/jobs writting


bin/kafka-console-consumer.sh  --topic heart-data --bootstrap-server 10.0.0.4:9092

bin/kafka-topics.sh --list --bootstrap-server 10.0.0.4:9092

bin/kafka-console-producer.sh --topic heart-data --bootstrap-server 10.0.0.4:9092























