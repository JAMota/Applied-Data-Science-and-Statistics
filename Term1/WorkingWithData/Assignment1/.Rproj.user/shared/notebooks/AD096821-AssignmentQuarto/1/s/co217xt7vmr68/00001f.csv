"0","##continuing from here because otherwise the reference won't work"
"0",""
"0","## the mice library already turned on the relevant variable for the imputation modelling turning only the imid(unique id) and year variable which is not useful for the imputations done on a year to year basis therefore I don't need to tweak it manually using pred <-imp$predictorMatrix"
"0",""
"0","## I might disable the size, priority or updates if needed though but they seemed to be needed since they make the amount missing values depends on these (basically auxiliary variables)"
"0",""
"0",""
"0","## https://stefvanbuuren.name/fimd/workflow.html  // go to 5.1"
"0","## mice documentation is *chef's kiss*"
"0",""
"0",""
"0","##the imputations are done so now we will use the with function from mice to fit the model"
"0","## 2nd workflow step"
"0",""
"0","##hypotheses bigger organisations take longer to recover from cyber attack due to the sheer volume of data in their possession"
"0",""
"0","##for model fitting "
"0","modelled2022 = complete(imp2022,1)"
"0",""
"0","modelBase = lm(sizea ~  restore, data = modelled2022)"
"0",""
"0","modelFull = lm(sizea ~  restore + attackBreaching + attackPhising + attackInfection + managementCyber + managementCyber + rulesSecurityConfigs + rulesUserControl + rulesUpdating + policyPrivate + policyData + policyStaffAccess, data = modelled2022)"
"0",""
"0","##removed ""higher"" p values"
"0","modelFirstChopping = lm(sizea ~  restore  + attackPhising + attackInfection + managementCyber, data = modelled2022)"
"0",""
"0","modelSecondChopping = lm(sizea ~  restore  + attackPhising + managementCyber , data = modelled2022)"
"0",""
"0","modelThirdChopping = lm(sizea ~  restore  + attackPhising , data = modelled2022)"
"0",""
"0",""
"0","tab_model(modelBase, modelFull, modelFirstChopping, modelSecondChopping, modelThirdChopping,"
"0","            show.ci= FALSE,"
"0","            title = ""Models comparison"")"
"0",""
"0","##as we can observe the second to last model is the best because it give us the best p values out of all the other models"
"0",""
"0",""
"0",""
"0","fitModelBase = with(imp2022, lm(sizea ~  restore))"
"0",""
"0",""
"0","##now lets test with all the variables"
"0",""
"0","##the with function has 2 functions, fill the missing value and then do the analysis, this way we avoid having to use complete function to gather all the data and then use the lappy to fit he model "
"0","?with"
"0",""
"0","fitModelAll2022 = with(imp2022, lm(sizea ~  restore  + attackPhising))"
"0",""
"0","fitModelAll2021 = with(imp2021, lm(sizea ~  restore  + attackPhising + managementCyber))"
"0",""
"0","fitModelAll2020 = with(imp2020, lm(sizea ~  restore  + attackPhising + managementCyber))"
"0",""
"0","fitModelAll2019 = with(imp2019, lm(sizea ~  restore  + attackPhising + managementCyber))"
"0",""
"0","fitModelAll2018 = with(imp2018, lm(sizea ~  restore  + attackPhising + managementCyber))"
"0",""
"0",""
"0",""
"0",""
"0",""
"0",""
"0","## conditioning based on all variables is reasonable on these type of data sets because of the relatively small amount of variables after cleaning."
"0","## As a rule of thumb using every available information created imputations with minimal bias and maximum efficiency "
"0",""
