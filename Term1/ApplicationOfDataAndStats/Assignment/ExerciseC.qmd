---
title: "Exercise C"
format: pdf
editor: visual
---

## Exercise C

```{r, echo=FALSE}
library(haven)
library(tidyverse)
library(dplyr)
library(geometry) 
library(formatR)
library(Amelia)
library(mice)
library(VIM)
library(labelled)
library(GGally)
library(ggplot2)
library(ggthemes)
```


```{r tidy=TRUE, tidy.opts=list(width.cutoff=72)}
##loading all the R workspace data

load("C:/AppliedDataScienceAndStatistics/Applied-Data-Science-and-Statistics/Term1/ApplicationOfDataAndStats/Assignment/datasets-20221221/January_2013.RData")
load("C:/AppliedDataScienceAndStatistics/Applied-Data-Science-and-Statistics/Term1/ApplicationOfDataAndStats/Assignment/datasets-20221221/January_2014.RData")
load("C:/AppliedDataScienceAndStatistics/Applied-Data-Science-and-Statistics/Term1/ApplicationOfDataAndStats/Assignment/datasets-20221221/January_2015.RData")
load("C:/AppliedDataScienceAndStatistics/Applied-Data-Science-and-Statistics/Term1/ApplicationOfDataAndStats/Assignment/datasets-20221221/new_substations.RData")
dataCharacteristics = read_csv("C:/AppliedDataScienceAndStatistics/Applied-Data-Science-and-Statistics/Term1/ApplicationOfDataAndStats/Assignment/datasets-20221221/Characteristics.csv")
```


## Exercise C 1.i

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72)}

summary(dataCharacteristics)

```

To visualise the distributions of the percentage of industrial and commercial costumer, transformer ratings and transformer types 
We will plot a histogram of each of these variables

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72)}

ggplot(dataCharacteristics, aes(Percentage_IC)) + 
  geom_histogram(bins = 30, fill = "blue", color = "black") +
  ggtitle("A Histogram of the percentage of industrial costumers ") +
  xlab("Ratio of commerical to industrial costumers") +
  ylab("Number of occurences")

```
The histogram here the number of occurrences cluster around fully commercial costumers and fully industrial costumers where both these values have a much higher number of occurrences than any other percentage ratio of costumers.
As the number of industrial costumers increase, the number of occurrences slowly decreases until it reach it's lowest near the 50 percentile, barely increasing again around the 80 percentile until reaching another high peak on 100% industrial costumers, following what it seems to be a very steep u-shaped distribution also called u-quadratic distribution.


```{r tidy=TRUE, tidy.opts=list(width.cutoff=72)}

ggplot(dataCharacteristics, aes(Transformer_RATING)) + 
  geom_histogram(bins = 30, fill = "blue", color = "black") +
  ggtitle("A Histogram of the power delivered by the substations") +
  xlab("Power delivered by the substation") +
  ylab("Number of occurences")

```

As we can see in the histogram above the amount of power being delivered to the substations is the highest around 500 and second highest around 300.
It is also evident that there is a large gap around amounts of power being delivered to the substation.
We can also see that with the exception to 0 or near 0 power delivered and two other values that can possible be outliers the number of occurrences increase as we get closer to 500 power delivered by the substations, following what would resemble a normal distribution.


```{r tidy=TRUE, tidy.opts=list(width.cutoff=72)}

ggplot(dataCharacteristics, aes(TRANSFORMER_TYPE)) + 
  geom_bar(fill = "blue", color = "black") +
  ggtitle("Occurences count per type of tranformer implemented in a substation") +
  xlab("Type of transformer: Ground mounted and Pole mounted") +
  ylab("Number of occurences")

```
As we can see the number of ground mounted substations is almost 3 times bigger than the pole mounted substations.


## Exercise C 1.ii

There are several ways to describe the relationships between different characteristics:

 - Correlation: This measures the strength and direction of the relationship between two variables. A positive correlation means that as one variable increases, the other variable also increases. A negative correlation means that as one variable increases, the other variable decreases.
  - Regression: This is a statistical method used to find the relationship between a dependent variable and one or more independent variables. It can be used to predict the value of the dependent variable based on the values of the independent variables.
  - Clustering: This is a method used to group similar observations together based on their characteristics. Clustering can be used to identify patterns or relationships in the data.
  - Dimensionality reduction: This is a technique used to reduce the number of variables in a dataset while preserving as much information as possible. This can be useful for visualizing and understanding relationships between variables.
  - Visualization: This is a way of representing data graphically, such as with charts, plots, and maps. Visualization can help to identify patterns and relationships in the data.
  
We have already have resorted to visualization of the distributions on the previous question so now I will be visualising and correlation each of the variables against each other.

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72)}
## variables to compare: transformer type, number of customers, rating, percentage of I&C customers and number of feeders
## these are: TRANSFORMER_TYPE, TOTAL_CUSTOMERS , Transformer_RATING , Percentage_IC and LV_FEEDER_COUNT

## lets start with transformer type comparison against all other variable
## the first one will be comparing it with total customers

ggplot(data = dataCharacteristics, aes(x = TRANSFORMER_TYPE, y = TOTAL_CUSTOMERS, fill = TRANSFORMER_TYPE)) + 
  geom_boxplot() +
  ggtitle("Box plot of transformer type and number of costumers") +
  xlab("Type of transformer") +
  ylab("Number of costumers")




```
As we can clearly observe the type of transformer is a strong indicator of the number of costumers as pole mounted substations values from the minimum third quantile values equal or approximate to zero comparing to ground mounted substations, these already have a number of costumers superior to 0 on the first quartile and the entire interquartile range holds values only present on the top quartile of the pole mounted substations.


```{r tidy=TRUE, tidy.opts=list(width.cutoff=72)}

modelTransTypeNCostumer = lm(TOTAL_CUSTOMERS ~ TRANSFORMER_TYPE, data = dataCharacteristics)

summary(modelTransTypeNCostumer)

```
As we can see from the summary of the linear model, a substation being pole mounted largely decreases the number of costumers in such substation.
It is also important to notice the the multiple R-squared and adjusted R-squared values as they signify that the type of transformer mounted only explains explains â‰ˆ 21% of the variation in the number of costumers.

Now we will proceed to analyse the comparison of transformer type and transformer rating.

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72)}

ggplot(data = dataCharacteristics, aes(x = TRANSFORMER_TYPE, y = Transformer_RATING, fill = TRANSFORMER_TYPE)) + 
  geom_boxplot() +
  ggtitle("Box plot of transformer type and power delivered by substation") +
  xlab("Type of transformer") +
  ylab("Power delivered by substation")


```
We can observe again that the type of transformer is a strong indicator of the power delivered by the substation, as with exception of 2 outliers the pole mounted entire range of power delivered is smaller then the first quartile of power delivered by ground mounted substations. As such it is clear how impactful are the type of transformer in the power delivered to the substations.

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72)}

modelTransTypePowerDelivery = lm(Transformer_RATING ~ TRANSFORMER_TYPE, data = dataCharacteristics)

summary(modelTransTypePowerDelivery)

```
As we can see from the summary of the model the type of transformer has a massive impact determining the amount of energy supplied to the substation and 

```{r tidy=TRUE, tidy.opts=list(width.cutoff=72)}


```
